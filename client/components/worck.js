запрос только статус open?
если ищем только открытые  как тогда обнавляем статусы?
какие данные нужны для отображения?

как сортировать в базе
как делать выборку постранично
как запускать функцию через n часов